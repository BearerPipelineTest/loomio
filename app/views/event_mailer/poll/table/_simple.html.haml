- poll = event.eventable.poll
- simple = ['proposal', 'count', 'poll'].include?(poll.poll_type)
- poll_options = simple ? poll.poll_options : poll.poll_options.sort_by {|o| -(o.total_score)}
%table
  %thead
    %tr
      %th
      %th.text-left= t('common.option')
      - if poll.poll_type == 'ranked_choice'
        %th.text-right= t('poll_ranked_choice_form.rank')
      %th.text-right= t('poll_ranked_choice_form.points')
      - if !simple
        %th.text-right= t('membership_card.voters')
        %th.text-right= t('poll_ranked_choice_form.average')
      %th.text-right= t('poll_ranked_choice_form.percent')
      - if poll.poll_type != 'ranked_choice'
        %th.text-left= t('membership_card.voters')
  %tbody
    - poll_options.each_with_index do |option, index|
      %tr
        - if (index == 0 && poll.chart_type == 'pie')
          %td.pr-2.py-2{rowspan: poll.poll_options.size} 
            = render 'event_mailer/poll/chart/pie', poll: poll
        - if  poll.chart_type == 'bar'
          %td.pr-2.py-2{style: 'width: 128px'}
            %table{style: "width: 100%"}
              %tr
                %td
                  %table{style: "width: #{option.score_percent}%"}
                    %tr
                      %td{height: '24px', style: "background-color: #{option.color}"}
        %td{style: "border-left: solid #{(poll.chart_type == 'pie') ? 4 : 0}px #{option.color}"}= option.display_name(zone: @recipient.time_zone)
        - if poll.poll_type == 'ranked_choice'
          %td.text-right=index+1
        %td.text-right= option.total_score
        - if !simple
          %td.text-right= option.voter_ids.length
          %td.text-right= option.average_score
        %td.text-right #{option.score_percent.to_i}%
        - if poll.poll_type != 'ranked_choice'
          %td.d-flex.align-center.text-left.justify-left
            - User.where(id: option.voter_ids).each do |user|
              =render 'base_mailer/avatar', user: user, size: 24
